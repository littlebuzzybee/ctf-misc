default(parisizemax, 1G);
p = 101177610013690114367644862496650410682060315507552683976670417670408764432851;
xG = Mod(14374457579818477622328740718059855487576640954098578940171165283141210916477, p);
yG = Mod(97329024367170116249091206808639646539802948165666798870051500045258465236698, p);
G = [xG, yG];
a1 = Mod(0, p);
a2 = Mod(208913474430283759938044884583915265967, p);
a3 = Mod(3045783791, p);
a4 = Mod(177776968102066079765540960971192211603, p);
a6 = yG^2 + a3*yG - xG^3 - a2*xG^2 - a4*xG;
xP = Mod(32293793010624418281951109498609822259728115103695057808533313831446479788050, p);
yP = polrootsmod(Y^2 + a3*Y - xP^3 - a2*xP^2 - a4*xP - a6, p)[1];
P = [xP, yP];
E = ellinit([a1,a2,a3,a4,a6], p);
N = ellorder(E, G);
factors = factor(N);
eqs = [];
for (i=1, 5, pi=factors[i,1]^factors[i,2]; Ni=N/pi; Gi=ellmul(E,G,Ni); Pi=ellmul(E,P,Ni); ni=elllog(E,Pi,Gi); eqs=concat(eqs, [Mod(ni, pi)]);)
print(chinese(eqs));

